{{!-- this page cannot use style.css from public and throws an error --}}
{{!-- I've hardcoded the style.css, but it still has the error --}}
{{!-- trying to fix the error rn --}}
{{!-- To-Do: make this page prettier --}}
<link rel="stylesheet" href="/style.css"/>


{{>header}}
<div class="admin-page-container">
    <h1>ADMIN PAGE for {{companyName}} (views/admin-crud-update.handlebars) update + delete button with alert window
    </h1>
    <h2>You can change the data of the user {{products.userID}} here:</h2>
    <div class="admin-edit-container">

        {{!-- getting one user from mongodb --}}
        <div>
            <p>User ID: {{products.userID}}</p>
            <p>Name: {{products.firstName}} {{user.lastName}}</p>
            <p>Email: {{products.email}}</p>
            <p>Phone: {{products.phoneNumber}}</p>
            <p>Check-In Date: {{products.checkIn}}</p>
            <p>Check-Out Date: {{products.checkOut}}</p>
        </div>

        {{!-- update user data --}}
        <form action="/adminpage" method="POST" autocomplete="off">

            <input type="hidden" name="userID" value="{{products.userID}}">

            <div class="new-name">
                <p>New First Name:</p>
                <input class="name field" id="new-name-date" placeholder="New First Name" name="firstName"
                    type="new-name" value="{{products.firstName}}" title="">
            </div>

            <div class="new-checkIn">
                <p>New Check-In Date:</p>
                <input class="checkIn field" id="new-checkIn" placeholder="New Check-In" name="checkIn"
                    type="new-checkIn" value="{{products.checkIn}}" title="">
            </div>

            <div class="new-checkOut">
                <p>New Check-Out Date:</p>
                <input class="checkOut field" id="new-checkOut" placeholder="New Check-Out" name="checkOut"
                    type="new-checkOut" value="{{products.checkOut}}" title="">
            </div>

            {{!-- To-Do: fix the delete buttn from this page --}}
            <button class="delete-button" href="/adminpage" onclick="confirmDelete({{products.userID}})">Delete</button>
            <button class="update-button" type="submit">Update User</button>
        </form>

    </div>
    <br>
    <a class="button" href="/adminpage">Go Back</a>

        <script>
            function confirmDelete(userID) {
                if (confirm("Are you sure you want to delete this reservation?")) {
                    fetch(`/admin-crud-update/delete/${userID}`, {
                    method: "GET", // Use POST method as method-override is enabled
                    })
                    .then((response) => {
                        if (response.ok) {
                        console.log("User deleted successfully");
                        location.reload(); // Reload the page after successful deletion
                        } else {
                        throw new Error("Failed to delete user");
                        }
                    })
                    .catch((error) => {
                        console.error(error);
                        alert("Failed to delete user");
                    });
                } else {
                    console.log("Reservation was not deleted");
                }
                }

        </script>

</div>
{{>footer}}
</body>
</html>